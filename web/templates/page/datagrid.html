{% extends "layout.html" %}

{% block contents %}
	<h1>
		{{ entityName | pascalCaseToPretty }}
		({{ entities | length }} {{ 'entry' if entities | length == 1 else 'entries' }})
	</h1>

	{% if entities | length %}
		<table class="table">
			<thead>
				<tr>
					{% for fieldName in entities[0].toDictId().keys() %}
						<th>{{ fieldName | pascalCaseToPretty }}</th>
					{% endfor %}
					{% if downloadLink is defined %}
						<th></th>
					{% endif %}
				</tr>
			</thead>
			<tbody>
				{% for entity in entities %}
					<tr>
						{% for fieldKey, fieldValue in entity.toDictId().iteritems() %}
							<td>
								{% if fieldKey == "id" %}
									<a href="{{ entity | entityLink }}">{{ fieldValue }}</a>
								{% elif fieldValue | isEntity %}
									<a href="{{ fieldValue | entityLink }}">{{ fieldValue.getName() | pascalCaseToPretty }}</a>
								{% else %}
									{{ fieldValue }}
								{% endif %}
							</td>
						{% endfor %}
						{% if downloadLink is defined %}
							<td>
								<a href="{{ downloadLink | format(entity.id) }}">Download</a>
							</td>
						{% endif %}
					</tr>
				{% endfor %}
			</tbody>
		</table>
	{% endif %}
{% endblock %}